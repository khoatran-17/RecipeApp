var _parcelHelpers = require("@parcel/transformer-js/lib/esmodule-helpers.js");
_parcelHelpers.defineInteropFlag(exports);
_parcelHelpers.export(exports, "renderUserListItem", function () {
  return renderUserListItem;
});
_parcelHelpers.export(exports, "submitUserRecipe", function () {
  return submitUserRecipe;
});
var _base = require('./base');
var _searchView = require('./searchView');
const renderUserListItem = recipe => {
  const markup = `
        <li>
            <a class="likes__link glass" href="${'TEST'}&userRecipe" >
                <figure class="likes__fig">
                    <img src="cookUserImg.bc82236c.png" alt="User Recipe Image">
                </figure>
                <div class="likes__data">
                    <h4 class="likes__name">${_searchView.limitTitle(recipe.title)}</h4>
                    <p class="likes__author">${recipe.publisher}</p>
                </div>
            </a>
        </li>
    `;
  _base.elements.userList.insertAdjacentHTML('beforeend', markup);
};
function submitUserRecipe(event) {
  console.log(this);
  event.preventDefault();
  // Get all the form data
  const formDataArr = [...new FormData(this)];
  console.log(formDataArr);
  // Get the ingredients section only and split them into parts
  const ingredients = formDataArr.filter(input => {
    return input[0].startsWith('ingredient') && input[1] !== '';
  });
  const ingredientsSplit = ingredients.map(ing => {
    const ingArr = ing[1].replaceAll(' ', '').split(',');
    if (ingArr.length !== 3) throw new Error('Ingredient input invalid!');
    return ingArr;
  });
  // Get the form data as an object and get the neccessary info
  const newRecipe = Object.fromEntries(formDataArr);
  const recipe = {
    title: newRecipe.title,
    publisher: newRecipe.publisher,
    cooking_time: +newRecipe.cookingTime,
    servings: +newRecipe.servings,
    ingredients: ingredientsSplit,
    id: (Date.now() + '').slice(-10)
  };
  console.log('HERE', newRecipe, recipe.title);
  // Render the newly added recipe
  const markup = `
        <li>
            <a class="likes__link glass" href="${'TEST'}&userRecipe" >
                <figure class="likes__fig">
                    <img src="cookUserImg.bc82236c.png" alt="User Recipe Image">
                </figure>
                <div class="likes__data">
                    <h4 class="likes__name">${_searchView.limitTitle(recipe.title)}</h4>
                    <p class="likes__author">${recipe.publisher}</p>
                </div>
            </a>
        </li>
    `;
  _base.elements.userList.insertAdjacentHTML('beforeend', markup);
  // Check if there are user recipes in localstorage and add it
  let allUserRecipes = JSON.parse(localStorage.getItem('userRecipe'));
  if (allUserRecipes) {
    allUserRecipes.push(recipe);
  } else {
    allUserRecipes = [recipe];
  }
  localStorage.setItem('userRecipe', JSON.stringify(allUserRecipes));
}
